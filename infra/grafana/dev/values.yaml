# platform-gitops/infra/grafana/dev/values.yaml

datasources:
  datasources.yaml:
    apiVersion: 1
    datasources:
    - name: VictoriaMetrics
      type: prometheus
      url: http://vmsingle-dev-victoria-metrics-single-server.dev-monitoring.svc:8428/vmsingle
      access: proxy
      isDefault: true

adminPassword: admin

persistence:
  enabled: true
  storageClassName: data-path
  size: 2Gi

grafana.ini:
  server:
    root_url: "%(protocol)s://%(domain)s/grafana/"
    serve_from_sub_path: true

sidecar:
  dashboards:
    enabled: true
    label: grafana_dashboard
    labelValue: "1"
    searchNamespace: dev-monitoring

# Dashboard sera carregado via sidecar (label grafana_dashboard=1).
# Criar o ConfigMap apos Grafana estar running:
#   kubectl create configmap grafana-dashboard-hpa-stress-test \
#     --from-file=hpa-stress-test.json=infra/grafana/dev/dashboards/hpa-stress-test.json \
#     -n dev-monitoring && kubectl label configmap grafana-dashboard-hpa-stress-test \
#     grafana_dashboard=1 -n dev-monitoring

resources:
  requests:
    cpu: 100m
    memory: 128Mi
  limits:
    cpu: 300m
    memory: 256Mi
